
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  
  <title>抽象容器类型 | LoongX&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="顺序容器&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;顺序容器有以下三种：可变长动态数组 vector、双端队列 deque、双向链表 list。&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;它们之所以被称为顺序容器，是因为元素在容器中的位置同元素的值无关，即容器不是排序的。将元素插入容器时，指">
<meta property="og:type" content="article">
<meta property="og:title" content="抽象容器类型">
<meta property="og:url" content="http://cvsink.github.io/2020/02/01/%E6%8A%BD%E8%B1%A1%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B/index.html">
<meta property="og:site_name" content="LoongX&#39;s Blog">
<meta property="og:description" content="顺序容器&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;顺序容器有以下三种：可变长动态数组 vector、双端队列 deque、双向链表 list。&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;它们之所以被称为顺序容器，是因为元素在容器中的位置同元素的值无关，即容器不是排序的。将元素插入容器时，指">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-02-01T07:48:22.000Z">
<meta property="article:modified_time" content="2020-02-01T13:22:14.755Z">
<meta property="article:author" content="LoongX">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="LoongX&#39;s Blog" type="application/atom+xml">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->
  
  
<script type="text/javascript">
var isWX = /micromessenger/i.test(navigator.userAgent);
if (isWX) {
  document.write('<br/><br/><h1 style="text-align: center;font-size:32px;" >╮(╯_╰)╭</h1><br/><br/><h4 style="text-align: center;" >请在浏览器中打开。</h4><br/><h4 style="text-align: center;" >Please open in the browser.</h4>');
  window.stop ? window.stop() : document.execCommand("Stop");
}
</script>


<meta name="generator" content="Hexo 4.2.0"></head>

<body>
<div id="container">
  <div id="wrap">
    <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <nav id="upper-nav" class="inner">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <div class="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        
          <a id="nav-github" class="nav-icon" href="https://github.com/CVSink" target="_blank" rel="noopener"></a>
        
      </div>
    </nav>
    <div id="header-title">
      
        <h1 id="blog-title-wrap">
          <a href="/" id="blog-title">LoongX&#39;s Blog</a>
        </h1>
      
    </div>
    <div id="contenedor">
      <ul class="cube">
        <li class="cara">MyLogo</li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
        <li class="cara"></li>
      </ul>
    </div>
    <nav id="main-nav">
      
        <a class="main-nav-link" href="/">Home</a>
      
        <a class="main-nav-link" href="/archives">Archives</a>
      
        <a class="main-nav-link" href="/about">About</a>
      
      <a class="main-nav-link st-search-show-outputs">搜索</a>
    </nav>
  </div>
</header>

    <div class="outer">
      <section id="main"><article id="post-抽象容器类型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <h3 href="/2020/02/01/%E6%8A%BD%E8%B1%A1%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B/" class="article-date">
  <time datetime="2020-02-01T07:48:22.000Z" itemprop="datePublished">2020-02-01</time>
</h3>
    
  </div>
  <div class="article-inner">
  <div class="curve-down">
  <div class="fill-content">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      抽象容器类型
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
        <font size=3>

<h3 id="顺序容器"><a href="#顺序容器" class="headerlink" title="顺序容器"></a>顺序容器</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;顺序容器有以下三种：可变长动态数组 vector、双端队列 deque、双向链表 list。<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;它们之所以被称为顺序容器，是因为元素在容器中的位置同元素的值无关，即容器不是排序的。将元素插入容器时，指定在什么位置（尾部、头部或中间某处）插入，元素就会位于什么位置。<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>这三种都是动态增长的，在这三者中选择的准则主要是关注插入特性以及对元素后续访问的要求。<br>关于选择三种顺序容器的准则：</p>
<ul>
<li>如果需要随机地访问一个容器，选择vector</li>
<li>如果已知要存储元素的个数，选择vector（通过reserve方法设置容量为指定值）</li>
<li>如果需要不只是在容器两端插入删除元素，酌情选择list和vector</li>
<li>如果需要在容器首部插入删除元素，选择deque，否则优先选择vector</li>
</ul>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如果既需要随机访问元素，又需要随机插入和删除元素，那么由主要操作来决定使用的容器类型，更有可能要自己设计使用更加复杂的数据结构。</p>
<h4 id="vector"><a href="#vector" class="headerlink" title="vector"></a>vector</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vector为可变长动态数组。vector表示一段<strong>连续</strong>的内存区域，每个元素被顺序存储在这段内存中。对vector随机访问效率很高，因为每次访问离vector起始处的位移都是固定的。但是，在任意位置（不是在vector的末尾）插入或删除元素，效率很低，此时它需要将待插入元素右边的每个元素都拷贝一遍。这种代价对于大型（要拷贝的数据多）、复杂（调用的构造函数和析构函数开销大）的类对象来说尤其大。</p>
<h6 id="vector的增长"><a href="#vector的增长" class="headerlink" title="vector的增长"></a>vector的增长</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;为了提高效率，vector并不是随每一个元素的增长而增长，而是当vector需要增长自身时，它实际分配的空间要比当前所需要的空间多一点（分配额外容量的大小由具体实现定义）。由于存在这种机制，<strong>实际上对于小的对象，vector在使用中比list效率更高</strong>。STL的Rogue Wave实现版本下分配的额外容量如下表：</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>长度(字节)</th>
<th>初始插入后的容量（元素个数）</th>
</tr>
</thead>
<tbody><tr>
<td>int</td>
<td>4</td>
<td>256</td>
</tr>
<tr>
<td>double</td>
<td>8</td>
<td>128</td>
</tr>
<tr>
<td>String</td>
<td>12</td>
<td>85</td>
</tr>
<tr>
<td>simple class</td>
<td>12</td>
<td>85</td>
</tr>
<tr>
<td>large simple class</td>
<td>8000</td>
<td>1</td>
</tr>
<tr>
<td>large complex class</td>
<td>8000</td>
<td>1</td>
</tr>
</tbody></table>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;由表可见，随着数据类型的<strong>长度</strong>越来越大，vector为其分配的额外容量越来越少，这也意味着vector的效率越来越低。<strong>在分配的额外空间满后，重分配后的缺省容量为之前的两倍</strong>。对于大型的数据类型，缺省容量较小，因此插入操作后频繁引发的重分配和拷贝操作成为使用vector的主要开销。<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;而数据类型的长度不仅仅是影响vector性能的唯一因素，由于在额外空间满后，每个元素需要依次调用析构函数和拷贝构造函数，类越复杂，调用拷贝构造函数和析构函数的开销也就越大，vector的性能也就越低。<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关于reserve方法（依据经验）：用一个非1的缺省值来调整vector的容量看起来总会引起性能的退化。例如对于string和double型的vector，通过reserve()会导致很差的性能，而增加大型复杂类的容量，又能大大改善其性能。</p>
<h6 id="vector的比较"><a href="#vector的比较" class="headerlink" title="vector的比较"></a>vector的比较</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;容器间的比较，是两个容器的元素之间成对地比较，从第一个元素开始开始往后进行比较。对于大于和小于比较，第一个不相同的元素哪个容器里的更大哪个容器就更大，如果都相同，元素个数多的容器更大；对于等于比较，只有所有元素都相同且两个容器元素个数相同，这两个容器才相同。（支持运算符重载）</p>
<h4 id="List"><a href="#List" class="headerlink" title="List"></a>List</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list为双向链表，允许双向遍历，在任意位置插入删除元素效率高，但对随机访问不友好，需要先遍历中间的元素，除此之外还需要额外的空间开销。</p>
<h6 id="vector和list的选择"><a href="#vector和list的选择" class="headerlink" title="vector和list的选择"></a>vector和list的选择</h6><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在vector和list插入1000w个元素来进行比较(单位为秒)：</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>list</th>
<th>vector</th>
</tr>
</thead>
<tbody><tr>
<td>int</td>
<td>1038</td>
<td>3.76</td>
</tr>
<tr>
<td>double</td>
<td>10.72</td>
<td>3.95</td>
</tr>
<tr>
<td>simple class</td>
<td>12.31</td>
<td>5.89</td>
</tr>
<tr>
<td>string</td>
<td>14.42</td>
<td>11.80</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>large simple class</td>
<td>360</td>
<td>2230</td>
</tr>
<tr>
<td>large complex class</td>
<td>2370</td>
<td>6700</td>
</tr>
</tbody></table>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;对于小的数据类型，vector有更好的性能，但对于大型的数据类型，list则有更好的性能。<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在小数据类型下，vector的额外容量分配较多，加之重分配后额外容量加倍，使得重分配次数大大减少，与此同时vector不用像list一样进行遍历，小数据类型的复制操作开销也相对较小，因此相较之下性能更佳。而在大数据类型下，vector额外容量少，大量的插入操作引发频繁的重分配（重分配又引起全部元素的析构和拷贝），相较之下list只需要遍历后直接插入，性能自然更佳。<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一种获得最好性能的方法是在vector的开销变得大时把vector转换成list（需要额外的转换时间）。另一种常用的方式是<strong>用指针存储大数据类型</strong>。指针长度仅为4，额外容量有256，而且指针的拷贝和释放不用调用该类的构造和析构函数。</p>
<h4 id="deque"><a href="#deque" class="headerlink" title="deque"></a>deque</h4><p>&nbsp;&nbsp;&nbsp;deque为双端队列。也表示一段连续的内存区域，与vector类型的不同在于其支持高效的在首部插入删除元素，这种功能通过两级数组结构来实现，第一级表示实际的容器，第二级指向容器的首和尾。</p>
<h3 id="关联容器"><a href="#关联容器" class="headerlink" title="关联容器"></a>关联容器</h3><p><br>关联容器有四种：set、multiset、map、multimap。关联容器内的元素是排序的。插入元素时，容器会按一定的排序规则将元素放到适当的位置上，因此插入元素时不能指定位置。</p>
<h4 id="map"><a href="#map" class="headerlink" title="map"></a>map</h4><h4 id="set"><a href="#set" class="headerlink" title="set"></a>set</h4>
      
    </div>
    <footer class="article-footer">
      <div class="article-footer-content">
        
        <a data-url="http://cvsink.github.io/2020/02/01/%E6%8A%BD%E8%B1%A1%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B/" data-id="ck63ao4ql0000g4ts110033x4" class="article-share-link">分享到</a>
        
      </div>
    </footer>
  </div>
  </div>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2020/01/19/%E6%B1%82%E9%9B%86%E5%90%88%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E9%9B%86/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">上一篇</strong>
      <div class="article-nav-title">求集合的所有子集</div>
    </a>
  
</nav>

  
</article>


</section>
      
      <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">近期文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/01/%E6%8A%BD%E8%B1%A1%E5%AE%B9%E5%99%A8%E7%B1%BB%E5%9E%8B/">抽象容器类型</a>
          </li>
        
          <li>
            <a href="/2020/01/19/%E6%B1%82%E9%9B%86%E5%90%88%E7%9A%84%E6%89%80%E6%9C%89%E5%AD%90%E9%9B%86/">求集合的所有子集</a>
          </li>
        
          <li>
            <a href="/2020/01/18/leetcode839-%E7%9B%B8%E4%BC%BC%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%BB%84/">leetcode839 相似字符串组</a>
          </li>
        
          <li>
            <a href="/2020/01/13/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/" rel="tag">并查集</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a><span class="archive-list-count">3</span></li></ul>
    </div>
  </div>

  
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 LoongX<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      .
      Theme by <a href="https://github.com/sun11/hexo-theme-paperbox" target="_blank">Paperbox</a>
    </div>
  </div>
</footer>
  </div>
  <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
  <a href="#search" class="mobile-nav-link st-search-show-outputs">搜索</a>
</nav>

  

<!-- totop start -->
<div id="totop">
	<a title="返回顶部"></a>
</div>
<!-- totop end -->

<!-- swiftype search start -->

<!-- swiftype search end -->



<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/lrsjng.jquery-qrcode/0.12.0/jquery.qrcode.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


</div>
</body>
</html>
